Welcome back to the session on Data Envelopment Analysis, in the last session we had seen the linear programming formulation of the DEA problem, now we are going to take up the example and the sales example that we had earlier discussed in the graphical method and actually formulate and solve those linear programming problems for each of the sales offices. So, this should give us a good practice of formulating the linear programming problem and then going to excel and solving those linear programming problems in excel and try to interpret the solutions and hopefully that matches with our conclusions from the graphical method. So, let us start with the two input problem that we had discussed earlier, recall that we had two inputs, the two inputs were the budget allocated to each of the sales offices and the team sizes the sales and marketing team that was available in each of the sales offices. And the output is kept constant, output is a single output the sales targets that each of the sales offices have to achieve. So, this was a earlier problem and we had actually solved that problem graphically, but now we are going to formulate a linear programming problem and essentially solve it in excel and let us hope that the answers match. So, just to recall how was the, what was our optimization problem for a DMU k, what was our objective function? The objective function was maximization of the numerator and numerator is where the weighted output is. So, objective function for this linear programming problem would be maximization of the weighted output. So, O1k, O2k, O3k, O4k and so on are the outputs of the DMU k the values and y1k, y2k, y3, y4k and so on are the weights attached by this DMU to each of the outputs, so that was our objective function. Recall that the first constraint was normalizing the denominator, denominator was where the weighted input, the denominator is the weighted input and therefore we are normalizing that weighted input to 1. So, for x 1 k, x 2 k, x 3 k are the weights attached by this DMU to each of the inputs and I 1 k, I 2 k, I 3 k and so on are the actual values of the inputs available to this sales office, this DMU. And then the other constraints which essentially say that using the weights of this DMU none of the DMUs should get an efficiency of more than 1. And then we rearrange the numerator and denominator such that the resultant constraints are linear functions of the input and output weights. So, for the first DMU, for the first DMU O11, O21, O31 will be the output values. However, the weights will be used for this DMU, the weights will be y 1 k, y 2 k, y 3 k they will not be y 1 1, y 2 1, y 3 1 and so on. DMU 1 is not using the weights that it has assigned itself, DMU 1 is essentially using the weights assigned by DMU k and making sure that they do not get an efficiency of more than 1. On the right-hand side of the constraint is x 1 k I 1 1, x 1 k is the weight attached by the first, attached by this DMU to the first input, I 1 1 of course is the first input for the first DMU. So, this constraint will ensure that DMU 1 does not get an efficiency of more than 1. Second, next this constraint will ensure that DMU 2 does not get a efficiency of more than 1 and so on for all the DMU's the kth DMU using the weights of DMU small k none of these DMUs should get a efficiency of more than 1. And this is a problem that is solved by DMU k therefore the decision problem for this DMU is to choose the values for its input weights and output weights. Therefore, the decision variables are x I k and x j k, here it is not for all case. So, let us formulate, let us formulate the problem for this scenario where we have two inputs budget and team size and one output. So, let us understand the notations for this problem. So, O11 we are trying to solve the problem for sales office 1, so O11 which is the only output that value is fixed 10 lakhs INR 10 lakhs so this is O11, there are two inputs so there will be I 1 1 and I 2 1, 2 because second input for the first DMU, second input for the first DMU that is team size and the team size value is 13. The budget value, the budget value for the first DMU, the budget value for the first DMU is 3 lakhs. So, since there is only one output we would need one weight, output weight so y 1 1 is the weight assigned for output 1 by DMU 1 so that is only output weight, the only output weight and there are going to be 2 input weights essentially your x 1 1 and x 2 1, x 1 1 is the input weight assigned by sales office 1 for the input 1, x 2 1 is the input weight assigned by DMU 1 for input 2. So, how is the efficiency going to be defined for this sales office? Efficiency is going to be defined as weighted output. What is going to be the weighted output? Weighted output is going to be y 1 1 O11, there is only one output weighted output, so numerator is only one single component y 1 1 O 1 1, denominator is a weighted input and that is going to be x 1 1 I 1 1 plus x 2 1 I 2 1. I 2 1 because input number 2 for DMU number 1. So, this is how the efficiency for sales office 1 is going to be defined. Remember that we are right now formulating the linear programming problem for the first sales office, we will have to formulate a similar optimization problem for each of the sales offices, independently of each other they will have to solve this solve their own linear programming problem. And of course we know the values of O11, we know that it is 10 lakhs, we know the value of I 1 1 which is 3 lakhs we know the value of I 2 1 which is 13 so here I know O 1 1, I know I 1 1, I know I 2 1, however I do not know the values of the weights x and y's and those are essentially decision variables, sales office is expecting that the optimization solution will tell us the weights for output as well as input. So, let us formulate the problem. What is going to be the objective function for this particular problem? What is going to be the objective function? Objective function is going to be maximization of the numerator, maximization of the numerator. So, maximization of y 1 1 O 1 1 is going to be the numerator, is going to be the objective function. What is going to be the first constraint? The first constraint is going to be normalizing the denominator to 1, denominator is weighted input and normalizing that to 1 will be the second, actually the first constraint. Now, what are the next set of constraints? Using these weights, using these weights, using these weights none of the DMU including DMU number 1, none of the DMU should get an efficiency of more than 1. So, it is going to be E1 less than or equal to 1, E2 less than or equal to 1, E3 less than or equal to 1, all these types of constraints. However, how are these efficiencies calculated? These efficiencies are calculated using the weights that sales office 1 is assigned. So, let us formulate those constraints also. So, as I said the objective function is going to be maximization of the numerator which is y 1 1 into 10 lakhs. The first constraint is going to be normalization of the denominator, so normalization of the denominator which is the weighted input x 1 1 into 3 lakhs plus x 2 1 into 13 has to be normalized to 1, so that we actually do not have a fraction, denominator is 1. And then the next set of constraints E 1 1, sorry E 1 less than or equal to 1, E 1 less than or equal to 1 will get translated to this linear equation where for this guy is the numerator, this guy is the denominator and we have simply moved the denominator to the right-hand side and therefore we get a linear equation in terms of y's and x, only one y and two x's. Using very similar logic the constraint E 2, so what is E 2 now? E 2 is the efficiency of the second sales office calculated using the weights of the first sales office, so that is going to be y 1 1 and O 1 2, O 1 2 is output number 1 for DMU number 2 that is going to be the numerator, denominator is going to be x 1 1 weights used by DMU 1 but the input available for DMU 2, first input for DMU 2 and x 2 1, x 2 1 remember is the weight for, x 2 1 is the weight used by first DMU for the second input multiplied by I 2 2, I 2 2 is the second input for the second DMU. And you know the values of O 1 2, I 1 2, I 2 2 but you do not know the values of y 1 1, x 1 1 and x 2 1 so you write that expression accordingly, which is going to be, output is going to be same, output is same for all the DMU that is 10 lakhs so this does not change, this does not change. The only thing that changes are the input values for the DMU 2. Similarly, for DMU 3, DMU 4 and DMU 5. So, these constraints will ensure that none of the DMU's get an efficiency of more than 1 using the weights calculated by DMU 1. And finally, what do we need to write? We need to write the decision variables, the decision variables are xâ€™s and y's, y 1 1, x 1 1, x 2 1 and so on, those have to be greater than or equal to 0, those are our decision variables. I hope the formulation is clear now, spent a minute just to understand this, digest this or the better thing to do is formulate a similar problem for sales office 2. Let us do that. What will change if we were to formulate the problem for sales office 2, it is going to be a separate linear programming problem. What will change? First thing that will change are the weights, these are the weights assigned by sales office 1. Now, we will start using the decision variables for sales office 2. What will those be? Those will be output 1 say sales office 2. So, the decision variable will be y 1 2, similarly it will be x 1 2 and x 2 2, those are going to be the three decision variables for DMU 2, so these are going to be for DMU 2. And then the normalizing constraint will change because normalizing constraint has 3 lakhs which was the input for DMU 1, 13 which was an input for DMU 1 instead of that we will use inputs for DMU 2, so let us formulate that problem. This is going to be the problem for DMU 2. As I said the decision variables are y 1 2, x 1 2, x 2 2, the normalizing constraint will have the inputs for DMU 2 but notice that these constraints change only in terms of y but they do not change in terms of these values because they are essentially the values available, the parameters available for DMU 1, DMU 2, DMU 3, DMU 4 and so on. So, I hope you have understood the difference between the two formulations. The decision variables are different, the normalizing variable, the normalizing constraint is different. Here the decision variables are different but the constraint structures are the same, all the five DMUs need to have an efficiency of less than 1. However, they should now calculate the efficiency using the weights used by sales office 2. And of course, we will make sure that the decision variables are non-negative. So, once again understand the difference between this formulation which was for sales office 1 and this formulation which is for sales office 2. One more time, let us do that one more time sales office 3. Now, why is this normalizing constraint used? This normalizing constraint is used because if you go back this was our third DMU, which has two inputs the budget is five lakhs and the team size is 7. So, for DMU number 3 what is I 1 3, I 1 3 is 5 lakhs and I 2 3 is 7, okay 5 lakhs and 7. Let us make sure that we have done this correctly. Sales office 2 done already, sales office 3. So, this is 5 lakhs and 7. We could have picked it up from here because these were the inputs, input values used in the constraint for the third DMU, third sales office. Once again what is going to change? The things that are going to change are the weights every sales office has a freedom to pick their own input weights and output weights. So, sales office 3 is going to say that I want y 1 3 to be the output weight, I want x 1 3 and x 2 3 to be the input weights, so they get to pick their own input and output weights, using their input weights and their output weights none of the DMU should get an efficiency of more than 1. These are all the constraints which essentially say that E k has to be less than or equal to 1. And decision variables have to be greater than 0, greater than or equal to 0. Make sense. Now, let us solve this problem, let us actually, so we have formulated the problem for the three sales offices you can formulate the problem for the other two sales offices that is not going to be too difficult once you have seen the first three formulations. Now, quickly let us look at the solution that we get from excel. And hopefully that matches with the solution that we have for, that we got from the graphical method. So, this is the formulation for the first LP or the first sales office, this is the data here, this is the data here. So, what is the only output? The only output is 10 lakhs, the only output is 10 lakhs, these are the inputs budget and team size 3 lakhs and 13 is the input for sales office 1. So, you know how to formulate these problems in linear, in excel now, how to formulate this linear programming problems in excel now. So essentially, I have asked excel to use these three cells, these three cells are to put the values for input weight and output weight. So, there are two input weights, input one weight and input two weight, those are the two input weights so x 1 1 and x 2 1. So, let us write that down this is going to be x 1 1 and this is going to be x 2 1 and this is your y 1 1, this is your y 1 1, this guy is your y 1 1. So, if you want to shade this you can shade this just to say that these are your decision variables, these are your decision variables. Now, what is your objective function? Objective function is maximization of the weighted output. So, output weight which is this cell here multiplied by the actual value of the output which is 10 lakhs which is in cell B2, so this is your objective function. Now, what is the first constraint? First constraint is the normalization of the denominator. What is denominator? Denominator is the weighted input. Now, what is weighted input? Input weight number one multiplied by the first input, input weight number two multiplied by the second input and there is a sum product function for that, I am very sure you are aware of this. So, this is going to be the left-hand side of your normalizing constraint and the denominator has to be normalized to 1. Therefore, this becomes our first constraint, now all these constraints, all these constraints are, all these constraints are essentially your E k less than or equal to one type of constraint, E k, so this is this constraint is once again the numerator of the first efficiency calculation, numerator of the first efficiency calculator, so output weight multiplied by the actual output. And what is the right-hand side? Right hand side if you recall the right-hand side or the first sales office was x 1 1 multiplied by the input x 2 1 multiplied by the input. So, x 1 1 multiplied by the input plus x 2 2 multiplied by the x 2 1 multiplied by the input. So, this is, and anyway you know that this is 1, because this was a normalizing constraint. Similarly, you write the other constraints also, you write the other constraints also, this is for DMU number 2, DMU number 2 will say that what is the left hand side, left hand side is the numerator, numerator is the output weight used by DMU 1, the output is 10 lakhs for everybody, the right hand side is weights used by DMU 1, which is right here x 1 1 and x 2 1. However, the values, input values will be the values corresponding to the DMU2, so 2,56,000 and team size of 9, you formulate those constraints, you formulate those constraints, you actually start with a blank slate, so ideally these values are 0 the problem is already solved actually. So, let me tell you how to do this, let me remove this, initially the cells are going to be empty, therefore the objective function is value is going to be 0, and all the constraints are simply going to be looking very trivial. Now, I go to the data solver, I have already formulated the problem. So, where do I set the objective? I set the objective by saying that it is my oh no, only this set, I 7 is where my j 7, j 7 is where my objective function is. What do I want excel to change? I want excel to change these three guys. So essentially, I want excel to change these three guys then I will write the constraint, I will write the constraints and just ask excel to solve. Now, let us interpret the answer, let us interpret the answer. So, using the weights that sales office 1 can assign, sales office 1 can assign any input weight and any output weight that it deems fit, use the weights to the best of your advantage is what DEA tells every DMU. So, DMU 1 says that these values, these values are the best values for me, these values are the best values for me. Using the best values the maximum efficiency, this is really the maximum value that optimization problem is able to get and what is that value, that value is 0.79, so even when I had the freedom to choose my own input weights and my own output weights, sales office 1 is saying that well, I am able to reach an efficiency of only 0.79, think of this as efficiency because denominator is 1, we have already normalized the denominator to 1 so whatever is the value of the numerator is actually the value of the efficiency. So, now we are saying that with my best efforts, with correctly assigning the input weights and output weights, sales office 1 is able to achieve only an efficiency of 0.79 about 0.8, so clearly sales office 1 is not an efficient DMU, makes sense, makes sense. So, let us go back and now solve the problem for DMU 2, let us solve the problem for DMU 2. This is like a cooking show where I have already cooked the dish but I am showing you again so this is the second DMU, this is the second DMU, same data, data is not changed, this data has not changed at all, this is still the same. The formulation however has changed there are still two input weights and one output weight so that has not changed, let me bring it down to 0 just to initialize the problem. So, now these cells are empty. What are these decision variables? This decision variable is our input weight number 1 for DMU 2, this is input weight number 2 for DMU 2, this is output weight number 1 for DMU 2. So, these are your decision variables, these are your decision variables. Now, what is the objective function, what is the objective function? Objective function is maximization of the weighted output, maximization of the weighted output. So, this is the output weight. What is the output value for DMU 2? For everybody it is 10 lakhs that is the sales target so that is your objective function. What is the first constraint? First constraint is the normalization of the denominator, normalization of the denominator. So, input weight multiplied by input for DMU 2, input weight multiplied by input for DMU 2. So, x 1 2 multiplied by 2,56,000, x 2 2 multiplied by 9 which is what is achieved by some product function and that is the normalization is to 1. Now, what question are we asking here? What is this constraint here? Using the weights for DMU 2, using the weights for DMU 2 DMU 1 should not get an efficiency of more than 1. So, what is the numerator for efficiency for DMU 1, which is the weighted output, weighted output, output weight multiplied by the actual output value 10 lakh and that has to be less than or equal to the denominator, denominator is the weighted input, input weight multiplied by the input for DMU 1 because this constraint is for E 1 less than or equal to 1 and input weight number 2 multiplied by 13 which is the team size for first sales office, first sales office. So, this constraint says that using the weights for DMU 2, DMU 1 should not get an efficiency of more than 1, this constraint is going to say that using the weights for DMU 2, DMU 2 should not get an efficiency of more than 1, if it is efficient it should get an efficiency of 1 but it nobody should get an efficiency of more than 1 because that is really weird, coating an efficiency value of more than 1 looks really weird so that is what we are going to say, that everybody should get an efficiency of less than or equal to 1. So, this constraint is going to say that using the weight for DMU number 2, DMU number 3 should not get an efficiency of more than 1 so this is the weighted output, weighted output is actually same for everybody, so output weight multiplied by the 10 lakh value, the right hand side is going to be different, this is where the input weight for DMU 2 will be used but the values for the input will come from DMU 3 which is 5 lakhs and 7. Now, using the same process that we described just now let us solve the problem, let us go to solver, I have already formulated the problem and anyway you are going to get this excel sheet. So, let me not get into how do you plug in the cell references in the solver add-in but let us simply hit the solve button and solve the problem, nice. So, we told DMU2, you pick your input weight values, you pick your output weight values and calculate your own efficiency. Let us see what that does. So, DMU 2 was able to say, if you give me the freedom to choose my own input and output weights I can show you that my efficiency value is 1, I can show you that my efficiency value is 1. So, obviously you must call DMU number 2, you must call sales office number 2 as an efficient DMU, because it is coating, it is able to quote an efficiency of 1. Whereas when you give the same freedom to sales office 1 the best sales office 1 was able to do was to report an efficiency of 0.79, when you gave the freedom to DMU 2 that sales office was able to reported say efficiency of 1. So, efficiency, in terms of efficiency comparison sales office 2 is efficient, sales office 1 is not. Let us look at third sales office solving its own problem. Now, let us do even lesser, once again I tell you that data is not changed, data is still the same, that is still the same, this DMU tries to assign some input weights, output weights so just to tell you this is x 1 3, this is x 2 3, second input third DMU and this is going to be y 1 3, sorry 3. And if we allow DMU 3, if we allow the sales office 3 to pick its own input and output weights DMU 3 is able to tell us that I can give you an efficiency of 1, I can give you an efficiency of 1. Now, therefore, I have to call DMU 3 also as an efficient DMU as efficient as DMU 2 because DMU 2 was also putting an efficiency of 1, DMU 3 is also able to put an efficiency of 1, on objective function of 1. What happens to sales office 4? Sales office 4, sales office 4, sales office 4 same freedom given to sales office 4, pick your own input weights and output weights. So, if you notice everybody is picking their own input weights and output weights for our DMU 4 the input weights and output weights the best possible input weights and output weights are given here which are not the same that were used by DMU number 3, which are not the same that were used by DMU number 2, which were clearly not the same that were used by DMU number 1. So, everybody picks their own appropriate input weights and output weights. But using the best possible combination of input weight and output weight, sales office 4 is again able to report only an efficiency of 0.84, not 1. Therefore, I must call sales office 4 as inefficient, inefficient they are not efficient. So, so far what have we figured out? Sales office 1 inefficient, 2 and 3 efficient, 4 again inefficient, 5, 5 turns out to be efficient, 5 turns out to be efficient. So, data is still the same you know how to solve this problem now, sales office 5 solves its own problem and reports an efficiency of 1, therefore sales office 5 is also efficient. So, what was our efficiency frontier? Sales office 5 was on the frontier, sales office 3 was on the frontier, sales office 2 was on the frontier. So, 2, 3 and 5, 2, 3 and 5 where the sales offices that were on the frontier. 1 and 4, 1 reported a value less than 1, 4 reported a value less than 1, so 1 and 4 turned out to be inefficient. Did we conclude the same in our graphical method? Let us go back and check that. This was our output from graphical method. So, 5, 2 and 3 were on the envelope, were on the efficiency envelope, 1 and 4 were not. So, obviously we got the same solution, actually the way we plotted the graphical output was based on the DEA analysis, so they have to match, at that time we showed you simply graphical interpretation of the way we had drawn the frontier, but in this session we are able to see why sales offices 5, 2 and 3 are actually on the frontier. Why are they on the frontier? Because they are able to report an efficiency of 1 for themselves. Whereas 1 and 4 when we ask them tell me your best efficiency, when we let them have the freedom of solving their own problem even then they were not able to report an efficiency of 1, I think sales office 1 was able to report an efficiency of 80 percent and sales office 4 was able to report an efficiency of only 84 percent. So, even in their own calculations they were not efficient and therefore our results match the graphical method results where if 1 and 4 do not lie on the efficiency frontier 5, 2 and 3 form the efficiency frontier. Hope this is clear now.