Welcome students to this new session on conjoint analysis. Last session, we saw how to formulate a conjoint analysis problem as a linear optimization problem. In this session, what we are going to do is we are actually numerically going to solve a problem. So, just to recall the final linear programming problem that we formulated was this. So, this was the final linear programming formulation, where we define ajkp as a parameter which is based on ykp and jkp which are the attribute values. Similarly, we defined another parameter called bjkp, which is ykp and jkp again, dependent on the attribute values, we define v as our new decision variable. We did some algebra added up all the a values added up all the b values. And then formulated the problem like this where Z was a almost a dummy variable, we defined that as a dummy variable. And then the first constraint was wp into ajkp plus vp into bjkp, jkp plus that zjk greater than or equal to zero. This is for all ordered pairs, which means that you will have one such constraint for each of the pairs. And we saw that the number of pairs will be n into n minus one divided by two. The last constraint was the almost like a normalization constraint where it is wp into Ap plus vp into Dp is equal to one. Now, notice, pay attention to the signs, we want weights to be greater than or equal to zero. Weights does not, it does not make sense to have weights less than zero. So, we want the weights to be greater than or equal to zero, we want the Z variable to be greater than or equal to zero. However, we can leave the V variable which is newly defined variable, unrestricted. So, that was the formulation. This formulation if you recall came from the classic article written in 1973. The article itself is now popularly called the LINMAP article. And we saw the basic concept behind that since the formulation itself came from that article. I thought the numerical example also can be close to that article, I definitely did not want to copy the exact example in that article. So, the article, you will realize that also as a two attribute data, and five product variants. Obviously, the numbers are mine, these numbers are mine. So, this is the data available to us on the five product variants product variant one scores, one point five on attribute one, a twelve on attribute two, product variant three scores a two point three on attribute one, and four on attribute two. Similarly, product variant five scores a nine on attribute one and one on attribute two. So, this is the product attribute data. What else do we need to solve the linear programming problem? Of course, we need the pairwise choices. And so choice data. So, this is the choice data. So, when we ask the consumer, what does she prefer? This is what the consumer told us, consumer dollars between the pair one, two, so this is this is for the pair, one, two, she prefers one over two, for the pair, one,three, this is not ordered, however, this is order. So, this is ordered pair, between the choices one and three, she prefers three over one, between the pair one and four, she prefers four over one, between five and one, she prefers five over one between two and three, she prefers two, between two and four. She prefers two and so on. Notice that since we have five product variants, n into n minus one, n is five. So, here n is five. n into n minus one divided by four. So, five into four divided by two will be ten. And we will have ten pairwise choice data, ten count that these are ten. So, one, two, three, four, five, six just to make sure that we have not missed out any pairwise combination. So, for all the ten combinations are available, we have choice data for all the ten pairs from this particular consumer. So, this is our choice data. This is our choice data. This is the attribute data. This is the choice data. Now, let us formulate and solve the optimization problem. Now, let me take you back to the slide this is the problem that we wish to formulate. Let us go to Excel. This is my optimization problem formulation, I have already kind of formulated the problem for you. So, I am just going to show you the cells and the formulae that I have entered. So, this is the attribute data for five product variants, same data, notice that I have not changed the data, this is the same data. Now, we need the A and B parameters, ajkp parameter and bjkp parameter. So, for the ordered pair jk, ajkp is essentially thus the attribute data for the kth variant and then the attribute data for the jth variant. So, when we say a121 ordered pair, I have already put an order here jk, ajk1. So, this is your ajk1, j is one here, k is two here. So, this means what is this? This means j is one here, k is two here, p is one here. So, ajkp, ajkp, p is the first attribute, p is the attribute and p is equal to one means first attribute. So, then we take the attribute for the kth variant first square it and then subtracted from the squared value of the jth variants attribute, so that it will be Y21 squared, Y21 because here we mean this is Ykp, this is Ykp because k is two. So, this is Ykp and this is Yjp, Yjp and obviously p is one, p is one, why do I say that? Let us go here, let us go to the definition. So, first, we want the kth variant and then we want the jth variant. So, hopefully we have done this. So, this is your kth variant and then your jth variant. Now, what is Y21? Y21 is ten which is this ten here. What is Y11? Y11 is one point five which is here, remember all this, this entire thing is to demonstrate the values for the first attribute similar exercise will have to be done for the second attribute, where p is actually equal to two here everywhere, we have assumed that p is one everywhere all these illustrative numbers essentially come from p is equal to one which means the first attribute. Now, I will show you that we have done the same thing for attribute number two also. So, what is ajk1? How will you write ajk1? ajk1 will be this ten squared minus one point five squared. So, essentially, I wanted to automate this whole numerical data pulling. So, I have used the VLOOKUP function, Anyway, the Excel sheet is going to be made available to you. So, you can actually make sure that I have used the VLOOKUP function in Excel correctly. Hopefully, I have used it. So, it is essentially what is this? What is this cell doing? This cell is calculating ten squared minus one point five squared, you can verify this, you can verify this that this is ten squared minus one point five squared. No, this is not ten, I want this guy, so ninety seven point seven five is the correct value that we have calculated. Now, why is this? Why is this negative three point zero one? one point five squared minus two point three squared should give us negative three point zero four. Just verify, let us verify. Let us do that for one more time and then we know that we have done it right. So, one point five squared minus two point three squared. And that should give us negative three point zero four. So, that is also correctly calculated. So, these are all ajk1 values, which are essentially calculated because I already had these values readily available, even though I did not use them,I made the equation more generic. Because I am directly pulling, I am not pulling values from this ten. Here, I am pulling directly values from the table. In fact, I have to look up,? If you notice, I am looking up in A2C2, A2C2 of pairwise choices. So, A2C2 of pairwise choices is this. This, I am looking up here, If you noticed, and I have to go to pairwise choices, and then the cell D2 from there, and I look up that D2 in this column A of this cell, So, you know how to use VLOOKUP function, I have done the same thing for ajk2 where p is actually equal to two, all these calculations are essentially for p equal to one. Hopefully, I have done this right. And why do I know that? Because in the VLOOKUP equation, I am referring to column index three, column index three is this column index C, C essentially is for attribute two, this is the column index C, this is the column index three, third column is the C column, C column is for attribute two. Similarly, I am using three here, this three here indicates the column index column index three column index three is clearly for Column C, and which is for attribute two. So, I am using, hopefully I am using the correct equation when I calculate the values ajk values for attributes two, so this is ajk2. Now, what was our B equation? B was simply negative two into right negative two vjkp was negative two into the Y attribute values for the kth variable are the kth variant and the jth variant. So, hopefully, how is this how is this ten calculated? This ten is calculated as negative two into this minus this hopefully, that turns out to be negative seventeen, this negative seventeen. once again this is for one. So, this is for attribute one, so all these values all these values are for attribute one, you should be able to readily verify them because they are right here values for attribute two are not readily available to you, you will have to pull them using VLOOKUP function even though I have pulled even these using VLOOKUP function. How do I know that this is for attribute one? I know that this is for the attribute one because I have used column index two, this is the column index two is column B, Column B is for attribute one. So, all these values are hopefully for attribute one. Similarly, I have calculated even though this should be small b. So, this should be for attribute two and the b parameter. So, b parameter is different. So, ajk1, ajk2, bjk1, bjk2 all calculated. Now, what else do we need to calculate? Summation values, the summation of all the ajk values and summation of all the bjk values for that particular attribute. That is simple summation sign, I have calculated this as summation of all the ajk values for attribute one, sixty four to be the summation of all the ajk values for attribute two, this two represents the summation of all the bjk values for attribute one this represents summation of all the bjk value for attribute two. So, these are your Ap and these one are the Ap’s and these two are the Dp’s. Ap’s and Dp’s also calculated. Now, let us define that decision variables where are our decision variables? Decision variables are the w's and v’s, where are my decision variables? Decision variables are right up here right, w variables and v variables. Let me show you the calculations. So, let me show you that this is what we get. So, let me erase all this. First of all, let me show you all the values. So, here I want Excel to print the value for w1 here I want Excel to print the value for w2. Here I want Excel to print the values of v1 here, I want Excel to print the value of v2. Now, these are all the Z variables. Now, where are the z variables? Look at the formulation, So, for the first constraint, which is inequality, I want to use the dummy variables zjk, zjk for each pair. So, for pair one, two, only z12 should come here, not any other Z variable. When I am considering pair one, three, only z13 should come in the constraint when I am looking at a pair fourty five only z45 should come in the constraint and none of the any other z variables. So, these are my pairs twelve, thirty one, fourty one Why is it not one, three ? why is this one, two, and three, one? Because look at the pairwise data it is one, two because it is ordered pair one, two but it is three, one because it is ordered this way. Even though the pair is one,three, the ordered pair is three, one therefore, we have written this as three, one, we have written this as four, one why four, one? Because the customer prefers four over one. So, we want to correctly order it and only define that variable. So, there we have not defined z14, z14 is not defined, because look at the formulation, it is for the ordered pair ordered pair jk for the ordered pair jk we have a variable zjk, since there is no ordered pair kj, we will not have a Z variable kj, there is the ordered pair is only four, one. So, I will only have z41 I will not have z14 in my formulation. Because look at this first consumer prefers variant four over variant one therefore, I will not have z14, I will only have z41. Similarly, I have z51, z23 z24, z25, z43 corresponding to all the ordered pairs three, five, four, five. These are all the ordered pairs and therefore I have those corresponding Z variables like I have learned to say this as Z variable, some of us said this as call this as z variable does not matter we are referring to the same variable. So, these are your z variables. So, this is what I have told Excel to print the z values here. Now, how do I write the constraints? Let me write the constraints with numerical values in them, then we will delete the numerical values where I am where are my formulation? This is my formulation. So, what is the formulation? For any ordered pair anyway we are in the ordered pair right now, this is the ordered pair one, two. So, this entire row corresponds to one,two. So, what is the constraint? For every ordered pair jk, ajkp into Wp plus bjkp into vp? So, where is my ajkp? These are my ajkp. Where is my w?. Where is bjkp? My bjkp. Where is my v? These are my v. Plus the lone z variables, the loan z variable for that particular ordered pair. so we have put up one here there is no other z. So, we have made it zero there is there should not be any other z variable in this constraint. So, we have made this as one all the other z's are zero. How do I write this constraint then? I will write the constraint value which is wp into a variable plus v into v variable plus the lone z variable. So, I will simply write this as sum product function. Sum product function of this row of this entire row where my data is and this row where I have asked Excel to print the values of my variables, v is my decision variable, w is my decision variable and z is also my decision variable. So, this is how I have defined the left-hand side of the constraint. And this has to be for each ordered pair. So, for pair one, two this is the constraint. This entire thing, multiplied by this entire thing. If you understand the concept now, for the second ordered pair, it will simply be some product this row from this row, for the third ordered pair, it will be some product of this row into the row where the values of the variables are. Similarly, for the next ordered pair and the next ordered pair and the next ordered pair and the next ordered pair and the next ordered pair all. So, all in all there will be ten such constraints each corresponding to each corresponding to each of the ordered pairs. Now, what is the constraint? constraint left hand side we have calculated as a sum product function, the right-hand sides are all zeroes and the constraint is an inequality where the left-hand side has to be greater than or equal to the right-hand side. So, these are all the n into n minus one divided by two so, ten constraints of this type. Let us make sure that we have not missed out three, four, five, six , seven, eight, nine and ten, constraints all these ten constraints. So, hopefully, we have not missed out on any ordered pair that chance was minimum, because we had anyway defined our a variables at least for the first attribute here. So, we made sure that we have not missed out on any pair therefore, hopefully here we have not missed out on any pair. And anyway, the ajk and the bjk values have been calculated using VLOOKUP function. So, once C6, is once, this pairwise. So, this is D2, this will be D4 right and the last will be D11. So, look at this D11,D11 and the B11 are really the last entries after that the VLOOKUP function will not find any entries and therefore, will not be able to calculate the ajk values and the bjk values and so on. So, the once it hits D11 and B11. That is it you cannot calculate anything further. So, VLOOKUP function will not return a sensible value, will not return a sensible value and that is that is another way of ensuring that we have accounted for all the ordered pair. So, all the ten ordered pairs have been accounted for. Let me delete that out to avoid confusion. Otherwise, we do not want to confusion here, but remember that what constraint is this? these are what constraints? These are 10 constraints, which correspond to this first constraint here, this is for each ordered pair, so, I have ten such. Now, the last constraint is a single constraint this is not for every ordered pair it simply says summation of wp into ap plus vp into Dp. So, where is that, where is my Ap? AP summation of all the ajk variables. So, this is my Ap. So, this is my A1 this is my A2 this is my D1 and this is my D2. So, as the formulation says Ap, which means that for every P there should be a capital A value, so, A1 and A2. For every P there should be a capital D value, so, p D1 and D2. So, I have all the four values that are calculated here and what should it get multiplied with. So, the formulation says w1 into A1 plus w2 into A2 v1 into D1 plus v2 into D2, I can simply do that by, so, I can do that very very manually by saying A1 into w1 plus A2 into W2 plus v1 into v1 plus v2 into v2. I can do that, but why I do that? I can simply use sum product function just the way I have been using. Sum product function and that once remember that this sum product function does not include the Z. So, I have only taken the A1, A2, D1, D2 values and corresponding w1, w2 v1, v2 values, notice that in the last constraint there is no z variable there is no z variable and the sign is an equality and the right-hand side has to be equal to one. So, this is the left-hand side this is the right-hand side you will get a left-hand side equal to one right now because the problem is already solved. So, what is the objective function? Where is my objective function? My objective function is summation of Z values. For each ordered pair jk I will add up the corresponding z values. So, for each ordered pair jk each ordered pair jk, I will simply add up the z variables where is my value? where are the values of my z? These are the values of my z. So, my objective function is simply summation of all these values. So, that is my objective function. It is a minimization object.